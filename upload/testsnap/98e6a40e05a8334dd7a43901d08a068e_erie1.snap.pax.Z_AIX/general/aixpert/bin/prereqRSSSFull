#!/usr/bin/ksh
# IBM_PROLOG_BEGIN_TAG 
# This is an automatically generated prolog. 
#  
# bos61H src/bos/usr/lib/security/aixpert/scripts/prereqRSSSFull.sh 1.1 
#  
# Licensed Materials - Property of IBM 
#  
# Restricted Materials of IBM 
#  
# COPYRIGHT International Business Machines Corp. 2009 
# All Rights Reserved 
#  
# US Government Users Restricted Rights - Use, duplication or 
# disclosure restricted by GSA ADP Schedule Contract with IBM Corp. 
#  
# @(#)93	1.1  src/bos/usr/lib/security/aixpert/scripts/prereqRSSSFull.sh, aixpert, bos61H, 0914A_61H 3/4/09 00:51:20
# IBM_PROLOG_END_TAG 
#       COMPONENT_NAME          : (AIXPERT) prereqRSSSFull.sh
#       FUNCTIONS               : None
#       ORIGINS                 : 27
#
#       Command Line Arguments  : None
#
#       OUTPUT                  : 0 - success, 1 - failure
#
#       Description             : This script checks whether ISS's
#				  RealSecure ServerSensor Full is installed or not.

# Firstly, check whether ISS fileset is installed or not.
/usr/bin/lslpp -l ISSXss.ServerSensor >/dev/null 2>&1
rc=$?

# ISS ServerSensor is installed
if [ $rc -eq 0 ]
then
	instType=`/usr/bin/grep RSTYPE /etc/realsecure/config | /usr/bin/awk -F "=" '{print $2}'`
	if [ "$instType" = "full" ]
	then
		exit 0
	fi
fi

# if ServerSensor is not installed or its not "full", return error
exit 1


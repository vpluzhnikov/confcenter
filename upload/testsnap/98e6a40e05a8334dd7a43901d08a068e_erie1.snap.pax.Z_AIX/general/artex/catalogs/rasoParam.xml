<?xml version="1.0" encoding="UTF-8"?>
<Catalog id="rasoParam" version="2.1">

  <ShortDescription><NLSCatalog catalog="artexcat.cat" setNum="38" msgNum="1">raso parameters</NLSCatalog></ShortDescription>
  <Description><NLSCatalog catalog="artexcat.cat" setNum="38" msgNum="2">Parameter definition for the raso command</NLSCatalog></Description>

  <CfgMethod id="raso">
    <Get type="current">
      <Command>/usr/sbin/raso -aF</Command>
      <Filter>/usr/bin/grep -v '= n/a$'</Filter>
      <Mask name="1" value="2">[[:space:]]*(.*) = (.*)</Mask>
    </Get>

    <Get type="nextboot">
      <Command>/usr/sbin/raso -r -aF</Command>
      <Filter>/usr/bin/grep -v '= n/a$'</Filter>
      <Mask name="1" value="2">[[:space:]]*(.*) = (.*)</Mask>
    </Get>

    <Set type="permanent">
      <Command>%a { [[ -n $RESTRICTED ]] &amp;&amp; echo "yes"; [[ -n $BOSBOOT ]] &amp;&amp; echo "no"; } | raso -p ${CMDLINE}</Command>
      <Argument>CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>

    <Set type="nextboot">
      <Command>%a { [[ -n $RESTRICTED ]] &amp;&amp; echo "yes"; [[ -n $BOSBOOT ]] &amp;&amp; echo "no"; } | raso -r ${CMDLINE}</Command>
      <Argument>CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>

  </CfgMethod>

  <ConstraintDef id="bosboot">
    <Description><NLSCatalog catalog="artexcat.cat" setNum="38" msgNum="3">bosboot</NLSCatalog></Description>
    <BuiltIn>bosboot</BuiltIn>
  </ConstraintDef>

  <ParameterDef name="biostat" cfgmethod="raso" type="boolean">
    <Description><NLSCommand command="/usr/sbin/raso -h biostat | /usr/bin/tail -n +2"/></Description>
  </ParameterDef>

<ParameterDef name="kern_heap_noexec" cfgmethod="raso" type="boolean" reboot="true" constraint="bosboot">
    <Description><NLSCommand command="/usr/sbin/raso -h kern_heap_noexec | /usr/bin/tail -n +2"/></Description>
    <Set type="permanent">
      <Argument>BOSBOOT=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>
    <Set type="nextboot">
      <Argument>BOSBOOT=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>
  </ParameterDef>

  <ParameterDef name="kernel_noexec" cfgmethod="raso" type="boolean" reboot="true" constraint="bosboot">
    <Description><NLSCommand command="/usr/sbin/raso -h kernel_noexec | /usr/bin/tail -n +2"/></Description>
    <Set type="permanent">
      <Argument>BOSBOOT=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>
    <Set type="nextboot">
      <Argument>BOSBOOT=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>
  </ParameterDef>

 <ParameterDef name="mbuf_heap_noexec" cfgmethod="raso" type="boolean" reboot="true" constraint="bosboot">
    <Description><NLSCommand command="/usr/sbin/raso -h mbuf_heap_noexec | /usr/bin/tail -n +2"/></Description>
    <Set type="permanent">
      <Argument>BOSBOOT=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>
    <Set type="nextboot">
      <Argument>BOSBOOT=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>
  </ParameterDef>

  <ParameterDef name="mtrc_commonbufsize" cfgmethod="raso" type="integer">
    <Description><NLSCommand command="/usr/sbin/raso -h mtrc_commonbufsize | /usr/bin/tail -n +2"/></Description>
  </ParameterDef>

  <ParameterDef name="mtrc_enabled" cfgmethod="raso" type="boolean" reboot="true" constraint="bosboot">
    <Description><NLSCommand command="/usr/sbin/raso -h mtrc_enabled | /usr/bin/tail -n +2"/></Description>

    <Set type="permanent">
      <Argument>BOSBOOT=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>

    <Set type="nextboot">
      <Argument>BOSBOOT=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
    </Set>
  </ParameterDef>

  <ParameterDef name="mtrc_rarebufsize" cfgmethod="raso" type="integer">
    <Description><NLSCommand command="/usr/sbin/raso -h mtrc_rarebufsize | /usr/bin/tail -n +2"/></Description>
  </ParameterDef>

  <ParameterDef name="tprof_cyc_mult" cfgmethod="raso" type="integer">
    <Description><NLSCommand command="/usr/sbin/raso -h tprof_cyc_mult | /usr/bin/tail -n +2"/></Description>
  </ParameterDef>

  <ParameterDef name="tprof_evt_mult" cfgmethod="raso" type="integer">
    <Description><NLSCommand command="/usr/sbin/raso -h tprof_evt_mult | /usr/bin/tail -n +2"/></Description>
  </ParameterDef>

  <ParameterDef name="tprof_evt_system" cfgmethod="raso" type="boolean">
    <Description><NLSCommand command="/usr/sbin/raso -h tprof_evt_system | /usr/bin/tail -n +2"/></Description>
  </ParameterDef>

  <ParameterDef name="tprof_inst_threshold" cfgmethod="raso" type="integer">
    <Description><NLSCommand command="/usr/sbin/raso -h tprof_inst_threshold | /usr/bin/tail -n +2"/></Description>
  </ParameterDef>
   
  <SubCat id="restricted">

    <ParameterDef name="recovery_action" cfgmethod="raso" type="boolean">
      <Description><NLSCommand command="/usr/sbin/raso -h recovery_action | /usr/bin/tail -n +2"/></Description>
      <Set type="permanent">
        <Argument>RESTRICTED=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
      </Set>
      <Set type="nextboot">
        <Argument>RESTRICTED=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
      </Set>
    </ParameterDef>

    <ParameterDef name="recovery_average_threshold" cfgmethod="raso" type="integer">
      <Description><NLSCommand command="/usr/sbin/raso -h recovery_average_threshold | /usr/bin/tail -n +2"/></Description>
      <Set type="permanent">
        <Argument>RESTRICTED=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
      </Set>
      <Set type="nextboot">
        <Argument>RESTRICTED=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
      </Set>
    </ParameterDef>

    <ParameterDef name="recovery_debugger" cfgmethod="raso" type="integer">
      <Description><NLSCommand command="/usr/sbin/raso -h recovery_debugger | /usr/bin/tail -n +2"/> </Description>
      <Set type="permanent">
        <Argument>RESTRICTED=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
      </Set>
      <Set type="nextboot">
        <Argument>RESTRICTED=yes;CMDLINE="$CMDLINE -o "%p"="%v1;</Argument>
      </Set>
    </ParameterDef>

    <ParameterDef name="recovery_framework" cfgmethod="raso" type="boolean" reboot="true" constraint="bosboot">
      <Description><NLSCommand command="/usr/sbin/raso -h recovery_framework | /usr/bin/tail -n +2"/></Description>
      <Set type="permanent">
        <Argument>BOSBOOT=yes;RESTRICTED=yes;CMDLINE=`echo $CMDLINE" -o "%p"="%v1`;</Argument>
      </Set>
      <Set type="nextboot">
        <Argument>BOSBOOT=yes;RESTRICTED=yes;CMDLINE=`echo $CMDLINE" -o "%p"="%v1`;</Argument>
      </Set>
    </ParameterDef>

  </SubCat>
</Catalog>
